.TH "2PING" "1" "" "" "2ping"
.SH NAME
.PP
2ping \- A bi\-directional ping utility
.SH SYNOPSIS
.PP
2ping [\f[I]options\f[]] \f[I]\-\-listen\f[] | host/IP
.SH DESCRIPTION
.PP
\f[C]2ping\f[] is a bi\-directional ping utility.
It uses 3\-way pings (akin to TCP SYN, SYN/ACK, ACK) and
after\-the\-fact state comparison between a 2ping listener and a 2ping
client to determine which direction packet loss occurs.
.PP
To use 2ping, start a listener on a known stable network host.
The relative network stability of the 2ping listener host should not be
in question, because while 2ping can determine whether packet loss is
occurring inbound or outbound relative to an endpoint, that will not
help you determine the cause if both of the endpoints are in question.
.PP
Once the listener is started, start 2ping in client mode and tell it to
connect to the listener.
The ends will begin pinging each other and displaying network
statistics.
If packet loss occurs, 2ping will wait a few seconds (default 10,
configurable with \f[I]\-\-inquire\-wait\f[]) before comparing notes
between the two endpoints to determine which direction the packet loss
is occurring.
.PP
To quit 2ping on the client or listener ends, enter ^C, and a list of
statistics will be displayed.
To get a short inline display of statistics without quitting, send the
process a QUIT signal (yes, that\[aq]s the opposite of what you would
think, but it\[aq]s in line with the normal ping utility).
.SH OPTIONS
.PP
\f[C]ping\f[]\-compatible options (long option names are
\f[C]2ping\f[]\-specific):
.TP
.B \-\-audible, \-a
Audible ping.
.RS
.RE
.TP
.B \-\-adaptive, \-A
Adaptive ping.
A new client ping request is sent as soon as a client ping response is
received.
If a ping response is not received within the interval period, a new
ping request is sent.
On networks with low rtt this mode is essentially equivalent to flood
mode.
.RS
.RE
.TP
.B \-\-count=\f[I]count\f[], \-c \f[I]count\f[]
Stop after sending \f[I]count\f[] ping requests.
.RS
.PP
\f[C]2ping\f[]\-specific notes: This option behaves slightly differently
from \f[C]ping\f[].
If both \f[I]\-c\f[] and \f[I]\-w\f[] are specified, satisfaction of
\f[I]\-c\f[] will cause an exit first.
Also, internally, \f[C]2ping\f[] exits just before sending
\f[I]count\f[]+1 pings, to give time for the ping to complete.
.RE
.TP
.B \-\-flood, \-f
Flood ping.
For every ping sent a period "." is printed, while for ever ping
received a backspace is printed.
This provides a rapid display of how many pings are being dropped.
If interval is not given, it sets interval to zero and outputs pings as
fast as they come back or one hundred times per second, whichever is
more.
.RS
.PP
\f[C]2ping\f[]\-specific notes: Detected outbound/inbound loss responses
are printed as ">" and "<", respectively.
Receive errors are printed as "E".
Due to the asynchronous nature of \f[C]2ping\f[], successful responses
(backspaces) may overwrite these loss and error characters.
.RE
.TP
.B \-\-interval=\f[I]interval\f[], \-i \f[I]interval\f[]
Wait \f[I]interval\f[] seconds between sending each ping.
The default is to wait for one second between each ping normally, or not
to wait in flood mode.
.RS
.RE
.TP
.B \-\-interface\-address=\f[I]address\f[], \-I \f[I]address\f[]
Set source IP address.
When in listener mode, this option may be specified multiple to bind to
multiple IP addresses.
When in client mode, this option may only be specified once, and all
outbound pings will be bound to this source IP.
.RS
.PP
\f[C]2ping\f[]\-specific notes: This option only takes an IP address,
not a device name.
Note that in listener mode, if the machine has an interface with
multiple IP addresses and an request comes in via a sub IP, the reply
still leaves via the interface\[aq]s main IP.
So this option must be used if you would like to respond via an
interface\[aq]s sub\-IP.
.RE
.TP
.B \-\-preload=\f[I]count\f[], \-l \f[I]count\f[]
If specified, \f[C]2ping\f[] sends that many packets not waiting for
reply.
.RS
.RE
.TP
.B \-\-pattern=\f[I]hex_bytes\f[], \-p \f[I]hex_bytes\f[]
You may specify up to 16 "pad" bytes to fill out the packets you send.
This is useful for diagnosing data\-dependent problems in a network.
For example, \f[I]\-p ff\f[] will cause the sent packet pad area to be
filled with all ones.
.RS
.PP
\f[C]2ping\f[]\-specific notes: This pads the portion of the packet that
does not contain the active payload data.
If the active payload data is larger than the minimum packet size
(\f[I]\-\-min\-packet\-size\f[]), no padding will be sent.
.RE
.TP
.B \-\-quiet, \-q
Quiet output.
Nothing is displayed except the summary lines at startup time and when
finished.
.RS
.RE
.TP
.B \-\-packetsize\-compat=\f[I]bytes\f[], \-s \f[I]bytes\f[]
\f[C]ping\f[] compatibility, this will set
\f[I]\-\-min\-packet\-size\f[] to this plus 8 bytes.
.RS
.RE
.TP
.B \-\-verbose, \-v
Verbose output.
In \f[C]2ping\f[], this prints decodes of packets that are sent and
received.
.RS
.RE
.TP
.B \-\-version, \-V
Show version and exit.
.RS
.RE
.TP
.B \-\-deadline=\f[I]seconds\f[], \-w \f[I]seconds\f[]
Specify a timeout, in seconds, before \f[C]2ping\f[] exits regardless of
how many pings have been sent or received.
Due to blocking, this may occur up to one second after the deadline
specified.
.RS
.PP
\f[C]2ping\f[]\-specific notes: This option behaves slightly differently
from \f[C]ping\f[].
If both \f[I]\-c\f[] and \f[I]\-w\f[] are specified, satisfaction of
\f[I]\-c\f[] will cause an exit first.
.RE
.PP
\f[C]2ping\f[]\-specific options:
.TP
.B \-h, \-\-help
Print a synposis and exit.
.RS
.RE
.TP
.B \-4, \-\-ipv4
Limit binds to IPv4.
In client mode, this forces resolution of dual\-homed hostnames to the
IPv4 address.
(Without \f[I]\-4\f[] or \f[I]\-6\f[], the first result will be used as
specified by your operating system, usually the AAAA address on
IPv6\-routable machines, or the A address on IPv4\-only machines.) In
listener mode, this filters out any non\-IPv4 \f[I]\-I\f[] binds, either
through hostname resolution or explicit passing.
.RS
.RE
.TP
.B \-6, \-\-ipv6
Limit binds to IPv6.
In client mode, this forces resolution of dual\-homed hostnames to the
IPv6 address.
(Without \f[I]\-4\f[] or \f[I]\-6\f[], the first result will be used as
specified by your operating system, usually the AAAA address on
IPv6\-routable machines, or the A address on IPv4\-only machines.) In
listener mode, this filters out any non\-IPv6 \f[I]\-I\f[] binds, either
through hostname resolution or explicit passing.
.RS
.RE
.TP
.B \-\-auth=\f[I]key\f[]
Set a shared key, send cryptographic hashes with each packet, and
require cryptographic hashes from peer packets signed with the same
shared key.
.RS
.RE
.TP
.B \-\-auth\-digest=\f[I]digest\f[]
When \f[I]\-\-auth\f[] is used, specify the digest type to compute the
cryptographic hash.
Valid options are \f[C]hmac\-md5\f[] (default), \f[C]hmac\-sha1\f[] and
\f[C]hmac\-sha256\f[].
.RS
.RE
.TP
.B \-\-debug
Print (lots of) debugging information.
.RS
.RE
.TP
.B \-\-inquire\-wait=\f[I]secs\f[]
Wait at least \f[I]secs\f[] seconds before inquiring about a lost
packet.
Default is 10 seconds.
UDP packets can arrive delayed or out of order, so it is best to give it
some time before inquiring about a lost packet.
.RS
.RE
.TP
.B \-\-listen
Start as a listener.
The listener will not send out ping requests at regular intervals, and
will instead wait for the far end to initiate ping requests.
A listener is required as the remote end for a client.
.RS
.RE
.TP
.B \-\-min\-packet\-size=\f[I]min\f[]
Set the minimum total payload size to \f[I]min\f[] bytes, default 128.
If the payload is smaller than \f[I]min\f[] bytes, padding will be added
to the end of the packet.
.RS
.RE
.TP
.B \-\-max\-packet\-size=\f[I]max\f[]
Set the maximum total payload size to \f[I]max\f[] bytes, default 512,
absolute minimum 64.
If the payload is larger than \f[I]max\f[] bytes, information will be
rearranged and sent in future packets when possible.
.RS
.RE
.TP
.B \-\-no\-3way
Do not perform 3\-way pings.
Used most often when combined with \f[I]\-\-listen\f[], as the listener
is usually the one to determine whether a ping reply should become a
3\-way ping.
.RS
.PP
Strictly speaking, a 3\-way ping is not necessary for determining
directional packet loss between the client and the listener.
However, the extra leg of the 3\-way ping allows for extra chances to
determine packet loss more efficiently.
Also, with 3\-way ping disabled, the listener will receive no client
performance indicators, nor will the listener be able to determine
directional packet loss that it detects.
.RE
.TP
.B \-\-no\-match\-packet\-size
When sending replies, 2ping will try to match the packet size of the
received packet by adding padding if necessary, but will not exceed
\f[I]\-\-max\-packet\-size\f[].
\f[I]\-\-no\-match\-packet\-size\f[] disabled this behavior, always
setting the minimum to \f[I]\-\-min\-packet\-size\f[].
.RS
.RE
.TP
.B \-\-no\-send\-version
Do not send the current running version of 2ping with each packet.
.RS
.RE
.TP
.B \-\-notice=\f[I]text\f[]
Arbitrary notice text to send with each packet.
If the remote peer supports it, this may be displayed to the user.
.RS
.RE
.TP
.B \-\-packet\-loss=\f[I]out:in\f[]
Simulate random packet loss outbound and inbound.
For example, \f[I]25:10\f[] means a 25% chance of not sending a packet,
and a 10% chance of ignoring a received packet.
A single number without colon separation means use the same percentage
for both outbound and inbound.
.RS
.RE
.TP
.B \-\-port=\f[I]port\f[]
Use UDP port \f[I]port\f[].
With \f[I]\-\-listen\f[], this is the port to bind as, otherwise this is
the port to send to.
Default is UDP port 15998.
.RS
.RE
.TP
.B \-\-stats=\f[I]interval\f[]
Print a line of brief current statistics every \f[I]interval\f[]
seconds.
The same line can be printed on demand by sending SIGQUIT to the 2ping
process.
.RS
.RE
.TP
.B \-\-srv
In client mode, causes hostnames to be looked up via DNS SRV records.
If the SRV query returns multiple record targets, they will all be
pinged in parallel; priority and weight are not considered.
The record\[aq]s port will be used instead of \f[I]\-\-port\f[].
This functionality requires the dnspython module to be installed.
.RS
.RE
.SH BUGS
.PP
None known, many assumed.
.SH AUTHOR
.PP
\f[C]2ping\f[] was written by Ryan Finnie <ryan\@finnie.org>.
.SH AUTHORS
Ryan Finnie.
